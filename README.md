This is WIP. I'll add explainations and docs when I got more time.